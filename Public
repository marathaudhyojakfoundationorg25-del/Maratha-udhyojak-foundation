// main.js
import { AppData } from './data.js';

// --- Global UI Logic ---

// Toggle mobile menu visibility
window.toggleMenu = () => {
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenu.classList.toggle('hidden');
};

// --- Dynamic Content Rendering ---

// Render Featured Members on Home Page
function renderFeaturedMembers() {
    const container = document.getElementById('featured-members');
    if (!container) return;

    // Take the first 3 members as featured
    const featured = AppData.members.slice(0, 3);
    container.innerHTML = featured.map(member => `
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg text-center transform hover:scale-105 transition duration-300">
            <img src="${member.photo}" alt="${member.name}" class="w-20 h-20 rounded-full mx-auto mb-4 object-cover border-4 border-violet-500">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">${member.name}</h3>
            <p class="text-violet-600 dark:text-violet-400 font-medium mb-2">${member.business}</p>
            <p class="text-sm text-gray-500 dark:text-gray-400">${member.category} | ${member.city}</p>
            <a href="profile.html?id=${member.id}" class="mt-4 inline-block text-sm font-semibold text-violet-600 hover:text-violet-800 dark:text-violet-400 dark:hover:text-violet-200 transition">View Profile &rarr;</a>
        </div>
    `).join('');
}

// Render Directors on Directors Page
function renderDirectors() {
    const container = document.getElementById('directors-list');
    if (!container) return;

    container.innerHTML = AppData.directors.map(director => `
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden border border-gray-100 dark:border-gray-700">
            <img class="w-full h-56 object-cover" src="${director.photo}" alt="${director.name} - ${director.title}">
            <div class="p-6">
                <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-1">${director.name}</h3>
                <p class="text-violet-600 dark:text-violet-400 font-semibold mb-3">${director.title}</p>
                <p class="text-gray-600 dark:text-gray-300">${director.description}</p>
            </div>
        </div>
    `).join('');
}

// Render Members on Directory Page
function renderMemberDirectory() {
    const container = document.getElementById('members-directory-grid');
    if (!container) return;

    // Simple grid view rendering
    container.innerHTML = AppData.members.map(member => `
        <a href="profile.html?id=${member.id}" class="block bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-xl transition duration-300 overflow-hidden group">
            <div class="flex items-center p-4">
                <img src="${member.photo}" alt="${member.name}" class="w-16 h-16 rounded-full object-cover mr-4 border-2 border-emerald-500">
                <div>
                    <h3 class="text-xl font-semibold text-gray-900 dark:text-white group-hover:text-violet-600 transition">${member.name}</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400">${member.business} - ${member.category}</p>
                    <p class="text-xs text-gray-400 dark:text-gray-500">${member.city}</p>
                </div>
            </div>
        </a>
    `).join('');
}

// Render Individual Member Profile Page
function renderMemberProfile() {
    const urlParams = new URLSearchParams(window.location.search);
    const memberId = parseInt(urlParams.get('id'));
    const member = AppData.members.find(m => m.id === memberId);
    
    const container = document.getElementById('member-profile-container');
    if (!container) return;

    if (!member) {
        container.innerHTML = '<div class="text-center py-20"><h1 class="text-3xl text-red-600">Member Not Found</h1><p class="mt-4 text-lg dark:text-gray-300">The profile you are looking for does not exist or has been removed.</p></div>';
        return;
    }

    // Populate the page dynamically
    document.getElementById('profile-name').textContent = member.name;
    document.getElementById('profile-business').textContent = member.business;
    document.getElementById('profile-category').textContent = member.category;
    document.getElementById('profile-city').textContent = member.city;
    document.getElementById('profile-contact').textContent = member.contact;
    document.getElementById('profile-bio').textContent = member.bio;
    document.getElementById('profile-photo').src = member.photo;
    
    // Social Links
    const socialLinks = document.getElementById('profile-social');
    socialLinks.innerHTML = `
        ${member.linkedin ? `<a href="${member.linkedin}" target="_blank" class="text-gray-500 hover:text-blue-700 dark:text-gray-400 dark:hover:text-blue-500 transition"><i class="fab fa-linkedin fa-2x"></i></a>` : ''}
        ${member.website ? `<a href="${member.website}" target="_blank" class="text-gray-500 hover:text-emerald-700 dark:text-gray-400 dark:hover:text-emerald-500 transition"><i class="fas fa-globe fa-2x"></i></a>` : ''}
        `;
}

// --- Initialization ---
window.onload = () => {
    // Apply theme from data.js on load
    AppData.applyTheme();
    
    // Apply dynamic configuration
    if (document.getElementById('hero-tagline')) {
        document.getElementById('hero-tagline').textContent = AppData.config.tagline;
    }

    // Call rendering functions based on page
    if (document.getElementById('home-page')) {
        renderFeaturedMembers();
    }
    if (document.getElementById('directors-page')) {
        renderDirectors();
    }
    if (document.getElementById('members-directory-page')) {
        renderMemberDirectory();
    }
    if (document.getElementById('member-profile-page')) {
        renderMemberProfile();
    }
};

